{"version":3,"sources":["images/tick.svg","components/applicationSummary.js","components/signature.js","components/spinner.js","components/pendingTask.js","appReducer.js","lib.js","services.js","App.js","index.js"],"names":["module","exports","__webpack_require__","p","ApplicationSummary","props","ratingYear","Date","getFullYear","_props$application","application","full_name","occupation","address","ratesBill","noOfDependants","spouse_or_partner","total_income","react_default","a","createElement","Fragment","className","onClick","onNext","Signature","_useState","useState","_useState2","Object","slicedToArray","error","setError","_useState3","_useState4","sigCanvas","setSigCanvas","resizeCanvas","clear","element","document","querySelector","canvas","getCanvas","setAttribute","offsetWidth","getElementsByClassName","style","cssText","useEffect","window","addEventListener","removeEventListener","name","back","isEmpty","next","signature","toDataURL","nextButtonLabel","title","subheading","build_default","ref","penColor","canvasProps","width","height","onBegin","declaration","signature_DeclarationApplicant","data","signature_DeclarationWitness","witness","DeclarationApplicant","DeclarationWitness","date","toLocaleDateString","weekday","year","month","day","location","Spinner","message","PendingTask","task","errorTitle","pending","spinner_Spinner","start","appReducer","state","action","type","objectSpread","token","currentScreen","signatureApplicant","signatureWitness","readyToSubmit","Error","initialState","started","result","reducer","concat","usePendingFetch","func","deps","_useReducer","useReducer","_useReducer2","dispatch","mounted","_ref","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","sent","t0","stop","apply","this","arguments","useAsyncRun","asyncTask","onResult","useFetchApplication","response","json","fetch","abrupt","attributes","fields","total_rates","dependants","income","moved_within_rating_year","useSubmitApplication","_callee2","_context2","signatures","image","role","method","mode","cache","credentials","headers","Content-Type","redirect","referrer","body","JSON","stringify","then","status","statusText","App","URLSearchParams","search","get","decodedToken","base64Url","split","base64","decodeURIComponent","atob","map","c","charCodeAt","toString","slice","join","parse","parseJwt","console","log","fetchTask","submitTask","pendingTask_PendingTask","applicationSummary_ApplicationSummary","signature_Signature","src","tick","alt","ReactDOM","render","src_App","getElementById"],"mappings":"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","file":"static/js/main.915054f4.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/tick.12268824.svg\";","import React from 'react';\nimport PropTypes from 'prop-types';\n\nexport const ApplicationSummary = (props) => {\n    let ratingYear = new Date().getFullYear() - 1;\n    let taxYear = (new Date().getFullYear() - 2) + '/' + (new Date().getFullYear() - 1);\n\n    let {\n        full_name,\n        occupation,\n        address,\n        ratesBill,\n        noOfDependants,\n        spouse_or_partner,\n        total_income} = props.application;\n\n    return (\n        <>\n            <div className=\"controlsBackground\">\n                <div className=\"controls\">\n                    <button className='next' onClick={props.onNext}>NEXT</button>\n                </div>\n            </div>\n            <div className=\"text-content\">\n                <h1>Application summary</h1>\n                <p className=\"summary\">\n                    Please check these details for your rebate claim.\n                </p>\n\n                <p>My name is <strong>{full_name}</strong> and my occupation is <strong>{occupation}</strong>.\n                </p>\n\n                <p>My address is <strong>{address}</strong> and I lived here on 1 July {ratingYear}.\n                    I have not moved within this rating year.</p>\n\n                <p>My {ratingYear} rates bill (including water) is <strong>${ratesBill}</strong>.</p>\n\n                <p>I have <strong>{noOfDependants}</strong> dependants.</p>\n\n                {spouse_or_partner ?\n                <p>\n                    Our combined income is <strong>${total_income}</strong>.\n                </p>\n                    :\n                <p>My income is <strong>${total_income}</strong>.</p>\n                }\n            </div>\n        </>\n    )\n};\n\nApplicationSummary.propTypes = {\n    application: PropTypes.shape({\n        full_name: PropTypes.string.isRequired,\n        occupation: PropTypes.string.isRequired,\n        address: PropTypes.string.isRequired,\n        ratesBill: PropTypes.string.isRequired,\n        noOfDependants: PropTypes.string.isRequired,\n        spouse_or_partner: PropTypes.bool.isRequired,\n        total_income: PropTypes.number.isRequired,\n    })\n};","import React, { useState, useEffect } from 'react';\nimport SignatureCanvas from 'react-signature-canvas';\nimport PropTypes from \"prop-types\";\n\nexport const Signature = (props) => {\n    const [error, setError] = useState(false);\n    const [sigCanvas, setSigCanvas] = useState(null);\n\n    const onNext = () => {\n        if (sigCanvas.isEmpty()) {\n            setError(true);\n            document.querySelector('.signature').className = 'signature error';\n        } else {\n            setError(false);\n            props.next({signature: sigCanvas.toDataURL()});\n        }\n    };\n\n    // resize canvas after window resize\n    useEffect(() => {\n        if (sigCanvas) {\n            window.addEventListener('resize', resizeCanvas);\n        }\n\n        return () => {\n          window.removeEventListener('resize', resizeCanvas);\n        };\n    }, [sigCanvas]);\n\n    // resize canvas on initial load\n    useEffect(() => resizeCanvas(), [sigCanvas]);\n\n    function resizeCanvas() {\n        if (sigCanvas) {\n            sigCanvas.clear();\n\n            let element = document.querySelector('.wrap-signature-canvas');\n            let canvas = sigCanvas.getCanvas();\n            canvas.setAttribute('width', 1);\n            canvas.setAttribute('height', 1);\n\n            canvas.setAttribute('width', element.offsetWidth);\n            canvas.setAttribute('height', (element.offsetWidth * 0.33));\n\n            showBackgroundImage();\n        }\n    }\n\n    function hideBackgroundImage() {\n        setError(false);\n        document.getElementsByClassName(\n            'sigBgImage')[0].style.cssText=\"visibility: hidden; opacity: 0;transition: visibility 0s .35s, opacity .35s linear;\";\n        document.querySelector('.signature').className = 'signature';\n    }\n\n    function showBackgroundImage() {\n        // setError(false);\n        document.getElementsByClassName(\n            'sigBgImage')[0].style.cssText=\"visibility: default; opacity: 1;transition: visibility 0s .35s, opacity .35s linear\";\n        // document.querySelector('.signature').className = 'signature';\n    }\n\n    return (\n        <>\n            <div className=\"controlsBackground\">\n                <div className=\"controls\">\n                    <button className='back' name=\"sign\" onClick={props.back}>GO BACK</button>\n                    <button\n                        className='next'\n                        name=\"sign\"\n                        onClick={onNext}>{props.nextButtonLabel}</button>\n                </div>\n            </div>\n\n            <div className=\"text-content\">\n                <h1>{props.title}</h1>\n                <p className=\"summary\">{props.subheading}</p>\n\n                <div className='signature'>\n                    <div className=\"wrap-signature-canvas\">\n                        { error && <p className=\"signature__error-msg\"><span>Please sign before you proceed</span></p>}\n                        <span className=\"sigBgImage\"></span>\n                        <SignatureCanvas\n                            ref={(ref) => {\n                                setSigCanvas(ref);\n                            }}\n                            penColor='#369'\n                            canvasProps={{width: '1', height: '1', className: 'sigCanvas'}}\n                            onBegin={() => hideBackgroundImage()}\n                        />\n                    </div>\n                    {props.declaration === 'applicant' && <DeclarationApplicant data={props.application}/>}\n                    {props.declaration === 'witness' && <DeclarationWitness data={props.witness}/>}\n                </div>\n            </div>\n        </>\n    )\n};\n\nconst DeclarationApplicant = (props) => {\n    return (\n        <p className=\"signatureSection\">\n            I, <strong>{props.data.full_name}</strong> of <strong>{props.data.address}</strong>,\n            occupation <strong>{props.data.occupation}</strong>, solemnly and sincerely declare that I believe the\n            information I have given on this form is true and correct, and I make this solemn declaration\n            conscientiously believing the same to be true and by virtue of the Oaths and Declarations Act 1957.\n        </p>\n    )\n};\n\nconst DeclarationWitness = (props) => {\n    let options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };\n    let date = new Date().toLocaleDateString('en-NZ', options);\n\n    return (\n        <p className=\"signatureSection\">\n            Declared at <strong>{props.data.location}</strong> this&nbsp;\n            <strong>{date}</strong> before me, <strong>{props.data.name}</strong>, <strong>{props.data.occupation}</strong>.\n        </p>\n    )\n};\n\nSignature.propTypes = {\n    title: PropTypes.string.isRequired,\n    declaration: PropTypes.string.isRequired,\n    application: PropTypes.shape({\n        full_name: PropTypes.string.isRequired,\n        address: PropTypes.string.isRequired,\n        occupation: PropTypes.string.isRequired,\n    })\n};","import React from 'react';\nimport '../App.css';\nimport PropTypes from \"prop-types\";\n\nexport const Spinner = (props) => {\n    return (\n        <div className=\"wrap-system-msg\">\n            <p className=\"system-msg system-msg--processing\">{props.message}</p>\n            <div className=\"sk-fading-circle\">\n                <div className=\"sk-circle1 sk-circle\"></div>\n                <div className=\"sk-circle2 sk-circle\"></div>\n                <div className=\"sk-circle3 sk-circle\"></div>\n                <div className=\"sk-circle4 sk-circle\"></div>\n                <div className=\"sk-circle5 sk-circle\"></div>\n                <div className=\"sk-circle6 sk-circle\"></div>\n                <div className=\"sk-circle7 sk-circle\"></div>\n                <div className=\"sk-circle8 sk-circle\"></div>\n                <div className=\"sk-circle9 sk-circle\"></div>\n                <div className=\"sk-circle10 sk-circle\"></div>\n                <div className=\"sk-circle11 sk-circle\"></div>\n                <div className=\"sk-circle12 sk-circle\"></div>\n            </div>\n        </div>\n    );\n};\n\nSpinner.propTypes = {\n    message: PropTypes.string.isRequired,\n};","import React from 'react';\nimport {Spinner} from \"./spinner\";\nimport PropTypes from \"prop-types\";\n\nexport const PendingTask = (props) => {\n\n    const {task, title, errorTitle} = props;\n\n    return (\n        <>\n            {task.pending &&\n            <Spinner message={title} />}\n\n            {task.error &&\n            <div className=\"wrap-system-msg\">\n                <p className=\"system-msg system-msg--error\">{errorTitle}</p>\n                <button className='next' onClick={() => task.start()}>Try Again</button>\n            </div>}\n        </>\n    );\n};\n\nPendingTask.propTypes = {\n    application: PropTypes.shape({\n        task: PropTypes.string.isRequired,\n        title: PropTypes.string.isRequired,\n        errorTitle: PropTypes.string.isRequired,\n    })\n};","export const appReducer = (state, action) => {\n    switch (action.type) {\n        case 'RECEIVED_TOKEN':\n            return {\n                ...state,\n                token: action.data.token,\n                witness: action.data.witness,\n                currentScreen: 'FETCH-APPLICATION',\n            };\n        case 'FETCHED_APPLICATION':\n            return {\n                ...state,\n                currentScreen: 'CONFIRM-APPLICATION',\n                application: action.application,\n            };\n        case 'CONFIRMED_APPLICATION':\n            return {\n                ...state,\n                currentScreen: 'SIGN-APPLICANT',\n            };\n        case 'APPLICANT_SIGNED':\n            return {\n                ...state,\n                currentScreen: 'SIGN-WITNESS',\n                signatureApplicant: action.signature,\n                signatureWitness: ''\n            };\n        case 'CANCEL_APPLICANT_SIGN':\n            return {\n                ...state,\n                currentScreen: 'CONFIRM-APPLICATION',\n                signatureApplicant: '',\n                signatureWitness: '',\n            };\n        case 'WITNESS_SIGNED':\n            return {\n                ...state,\n                currentScreen: 'SUBMITTING-APPLICATION',\n                signatureWitness: action.signature,\n                readyToSubmit: true\n            };\n        case 'CANCEL_WITNESS_SIGN':\n            return {\n                ...state,\n                currentScreen: 'SIGN-APPLICANT',\n                signatureApplicant: '',\n                signatureWitness: ''\n            };\n        case 'APPLICATION_SUBMITTED':\n            return {\n                ...state,\n                currentScreen: 'THANK-YOU',\n            };\n        default: throw new Error('Unhandled action type ' + action.type);\n    }\n};","import {useReducer, useEffect} from 'react';\n\nimport 'whatwg-fetch';\n\nconst initialState = {\n    started: false,\n    pending: false,\n    error: null,\n    start: null,\n    result: null,\n};\n\nconst reducer = (task, action) => {\n    switch (action.type) {\n        case 'init':\n            return initialState;\n        case 'ready':\n            return {\n                ...task,\n                start: action.start,\n            };\n        case 'start':\n            return {\n                ...task,\n                started: true,\n                pending: true,\n                error: false,\n            };\n        case 'result':\n            return {\n                ...task,\n                pending: false,\n                result: action.result,\n            };\n        case 'error':\n            return {\n                ...task,\n                pending: false,\n                error: action.error,\n            };\n        default:\n            throw new Error(`Unhandled action type: ${action.type}`);\n    }\n};\n\nexport const usePendingFetch = (func, deps) => {\n    const [state, dispatch] = useReducer(reducer, initialState);\n\n    useEffect(() => {\n        let mounted = true;\n\n        const start = async () => {\n            try {\n                if (deps[0]) {\n                    dispatch({type: 'start'});\n                    let result = await func();\n                    if (mounted) {\n                        dispatch({type: 'result', result});\n                    }\n                }\n            } catch (error) {\n                dispatch({type: 'error', error});\n            }\n        };\n\n        if (deps[0]) {\n            dispatch({type: 'ready', start});\n        }\n\n        return () => {\n            dispatch({ type: 'init' });\n            mounted = false;\n        };\n    }, deps);\n\n    return state;\n};\n\nexport const useAsyncRun = (asyncTask, onResult) => {\n    const start = asyncTask && asyncTask.start;\n    const result = asyncTask && asyncTask.result;\n\n    useEffect(() => {\n        if (start) {\n            start();\n        }\n\n        return () => {\n        };\n    }, [start]);\n\n    useEffect(() => {\n        if (result) {\n            onResult(result);\n        }\n    }, [result]);\n};\n\nexport function parseJwt (token) {\n    var base64Url = token.split('.')[1];\n    var base64 = decodeURIComponent(atob(base64Url).split('').map(function(c) {\n        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n    }).join(''));\n\n    return JSON.parse(base64);\n};\n","import 'whatwg-fetch';\nimport {usePendingFetch, useAsyncRun} from \"./lib\";\n\nexport const useFetchApplication = (token, onResult, deps) => {\n    const task = usePendingFetch(async () => {\n        let response = await fetch(`/api/v1/rebate_forms/?jwt=${token}`);\n        let json = await response.json();\n\n        return {\n            full_name: json.data.attributes.fields.full_name,\n            occupation: json.data.attributes.fields.occupation,\n            address: json.data.attributes.fields.location,\n            ratesBill: json.data.attributes.fields.total_rates,\n            noOfDependants: json.data.attributes.fields.dependants,\n            spouse_or_partner: json.data.attributes.fields.spouse_or_partner === 'yes',\n            total_income: json.data.attributes.fields.income.total_income,\n            moved_within_rating_year: json.data.attributes.fields.moved_within_rating_year === 'yes'\n        };\n    }, deps);\n\n    useAsyncRun(task, onResult);\n\n    return task;\n};\n\nexport const useSubmitApplication = (state, onResult, deps) => {\n    const task = usePendingFetch(async () => {\n        const {\n            token, \n            signatureApplicant, \n            signatureWitness, \n            application, \n            witness\n        } = state;\n\n        let data = {\n            \"data\": {\n                \"token\": `${token}`,\n                \"signatures\": [\n                    {\n                        \"image\": signatureApplicant,\n                        \"name\": application.full_name,\n                        \"role\": application.occupation,\n                        \"type\": \"applicant\"\n                    },\n                    {\n                        \"image\": signatureWitness,\n                        \"name\": witness.name,\n                        \"role\": witness.occupation,\n                        \"type\": \"witness\"\n                    }\n                ]    \n            }\n        };\n\n        let response = await fetch(`/api/v1/rebate_forms/sign`,{\n            method: 'POST', // *GET, POST, PUT, DELETE, etc.\n            mode: 'cors', // no-cors, cors, *same-origin\n            cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n            credentials: 'omit', // include, *same-origin, omit\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            redirect: 'follow', // manual, *follow, error\n            referrer: 'no-referrer', // no-referrer, *client\n            body: JSON.stringify(data), // body data type must match \"Content-Type\" header\n        }).then((response) => {\n            if (response.status >= 200 && response.status < 300) {\n                return response;\n            } else {\n                let error = new Error(response.statusText);\n                error.response = response;\n                throw error;\n            }\n        });\n\n        return await response.json();\n    }, deps);\n\n    useAsyncRun(task, onResult);\n\n    return task;\n};","import React from 'react';\nimport {useReducer, useEffect} from 'react';\n\nimport {ApplicationSummary} from \"./components/applicationSummary\";\nimport {Signature} from \"./components/signature\";\nimport {PendingTask} from \"./components/pendingTask\";\n\nimport {appReducer} from './appReducer';\nimport {useFetchApplication, useSubmitApplication} from './services';\nimport {parseJwt} from './lib';\n\nimport './App.css';\nimport tick from './images/tick.svg';\n\n\nfunction App() {\n    const [state, dispatch] = useReducer(appReducer, {});\n\n    useEffect(() => {\n        let urlParams = new URLSearchParams(window.location.search);\n        let token = urlParams.get('t');\n\n        try {\n            let decodedToken = parseJwt(token);\n            dispatch({type: 'RECEIVED_TOKEN', data: {token, witness: decodedToken.witness}});\n        } catch (error) {\n            console.log(error);\n        }\n    }, []);\n\n    const fetchTask = useFetchApplication(state.token, (result) => {\n        dispatch({type: 'FETCHED_APPLICATION', application: result})\n    }, [state.token]);\n\n    const submitTask = useSubmitApplication(state, () => {\n        dispatch({type: 'APPLICATION_SUBMITTED'});\n    }, [state.readyToSubmit]);\n\n    return (\n        <div className=\"App\">\n            <header>\n                <h2>Rates Rebate 2018/2019</h2>\n            </header>\n\n            <div className=\"content\">\n                <PendingTask\n                    task={fetchTask}\n                    title=\"Retrieving application...\"\n                    errorTitle=\"Error while retrieving application\"\n                />\n\n                <PendingTask\n                    task={submitTask}\n                    title=\"Submitting application...\"\n                    errorTitle=\"Error while submitting application\"\n                />\n\n                {state.currentScreen === 'CONFIRM-APPLICATION' &&\n                <ApplicationSummary\n                    application={state.application}\n                    onNext={() => dispatch({type: 'CONFIRMED_APPLICATION'})}\n                />}\n\n                {state.currentScreen === 'SIGN-APPLICANT' &&\n                <Signature\n                    declaration=\"applicant\"\n                    nextButtonLabel=\"NEXT\"\n                    application={state.application}\n                    title=\"Applicant signature\"\n                    subheading=\"Please sign to complete your application\"\n                    next={(data) => dispatch({type: 'APPLICANT_SIGNED', signature: data.signature})}\n                    back={() => dispatch({type: 'CANCEL_APPLICANT_SIGN'})}\n                />}\n\n                {state.currentScreen === 'SIGN-WITNESS' &&\n                <Signature\n                    declaration=\"witness\"\n                    nextButtonLabel=\"SUBMIT\"\n                    application={state.application}\n                    witness={state.witness}\n                    title=\"Witness signature\"\n                    subheading=\"Signature of person authorised to witness this declaration\"\n                    next={(data) => dispatch({type: 'WITNESS_SIGNED', signature: data.signature})}\n                    back={() => dispatch({type: 'CANCEL_WITNESS_SIGN'})}\n                />}\n\n                {state.currentScreen === 'THANK-YOU' &&\n                <div className=\"endScreen\">\n                    <h1>Thank you</h1>\n                    <p className=\"summary\">\n                        This declaration is now complete and ready to be processed.\n                    </p>\n                    <img src={tick} alt=\"tick\" className=\"img-tick\"></img>\n                </div>}\n            </div>\n        </div>\n    );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));"],"sourceRoot":""}