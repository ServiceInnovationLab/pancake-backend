{"version":3,"sources":["images/tick.svg","lib.js","components/applicationSummary.js","components/signature.js","components/spinner.js","components/pendingTask.js","appReducer.js","services.js","App.js","index.js"],"names":["module","exports","__webpack_require__","p","initialState","started","pending","error","start","result","reducer","task","action","type","Object","objectSpread","Error","concat","usePendingFetch","func","deps","_useReducer","useReducer","_useReducer2","slicedToArray","state","dispatch","useEffect","mounted","_ref","asyncToGenerator","regenerator_default","a","mark","_callee","wrap","_context","prev","next","sent","t0","stop","apply","this","arguments","useAsyncRun","asyncTask","onResult","formatDollars","amount","currency","length","undefined","decimalCount","decimal","thousands","Math","abs","isNaN","negativeSign","i","parseInt","Number","toFixed","toString","j","digits","slice","substr","replace","e","ApplicationSummary","props","ratingYear","Date","getFullYear","taxYear","_props$application","application","full_name","occupation","address","ratesBill","noOfDependants","spouse_or_partner","total_income","lived_in_property_1_July","moved_within_rating_year","rates_bill_formatted","total_income_formatted","react_default","createElement","Fragment","className","onClick","onNext","Signature","_useState","useState","_useState2","setError","_useState3","_useState4","sigCanvas","setSigCanvas","hideBackgroundImage","document","getElementsByClassName","style","cssText","querySelector","onBegin","name","back","isEmpty","signature","toDataURL","nextButtonLabel","title","subheading","react_signature_pad_wrapper_es","ref","penColor","canvasProps","redrawOnResize","declaration","signature_DeclarationApplicant","data","signature_DeclarationWitness","witness","DeclarationApplicant","DeclarationWitness","date","toLocaleDateString","weekday","year","month","day","location","Spinner","message","PendingTask","errorTitle","spinner_Spinner","appReducer","token","currentScreen","signatureApplicant","signatureWitness","readyToSubmit","useFetchApplication","response","json","fields","fetch","attributes","abrupt","total_rates","dependants","income","useSubmitApplication","_callee2","_context2","signatures","image","role","method","mode","cache","credentials","headers","Content-Type","redirect","referrer","body","JSON","stringify","then","status","statusText","App","URLSearchParams","window","search","get","decodedToken","base64Url","split","base64","decodeURIComponent","atob","map","c","charCodeAt","join","parse","parseJwt","console","log","fetchTask","submitTask","pendingTask_PendingTask","applicationSummary_ApplicationSummary","signature_Signature","src","tick","alt","ReactDOM","render","src_App","getElementById"],"mappings":"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","file":"static/js/main.c0da98b1.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/tick.12268824.svg\";","import {useReducer, useEffect} from 'react';\n\nimport 'whatwg-fetch';\n\nconst initialState = {\n    started: false,\n    pending: false,\n    error: null,\n    start: null,\n    result: null,\n};\n\nconst reducer = (task, action) => {\n    switch (action.type) {\n        case 'init':\n            return initialState;\n        case 'ready':\n            return {\n                ...task,\n                start: action.start,\n            };\n        case 'start':\n            return {\n                ...task,\n                started: true,\n                pending: true,\n                error: false,\n            };\n        case 'result':\n            return {\n                ...task,\n                pending: false,\n                result: action.result,\n            };\n        case 'error':\n            return {\n                ...task,\n                pending: false,\n                error: action.error,\n            };\n        default:\n            throw new Error(`Unhandled action type: ${action.type}`);\n    }\n};\n\nexport const usePendingFetch = (func, deps) => {\n    const [state, dispatch] = useReducer(reducer, initialState);\n\n    useEffect(() => {\n        let mounted = true;\n\n        const start = async () => {\n            try {\n                if (deps[0]) {\n                    dispatch({type: 'start'});\n                    let result = await func();\n                    if (mounted) {\n                        dispatch({type: 'result', result});\n                    }\n                }\n            } catch (error) {\n                dispatch({type: 'error', error});\n            }\n        };\n\n        if (deps[0]) {\n            dispatch({type: 'ready', start});\n        }\n\n        return () => {\n            dispatch({ type: 'init' });\n            mounted = false;\n        };\n    }, deps);\n\n    return state;\n};\n\nexport const useAsyncRun = (asyncTask, onResult) => {\n    const start = asyncTask && asyncTask.start;\n    const result = asyncTask && asyncTask.result;\n\n    useEffect(() => {\n        if (start) {\n            start();\n        }\n\n        return () => {\n        };\n    }, [start]);\n\n    useEffect(() => {\n        if (result) {\n            onResult(result);\n        }\n    }, [result]);\n};\n\nexport function parseJwt (token) {\n    let base64Url = token.split('.')[1];\n    let base64 = decodeURIComponent(atob(base64Url).split('').map(function(c) {\n        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n    }).join(''));\n\n    return JSON.parse(base64);\n}\n\n\nexport function formatDollars(amount, currency = '$', decimalCount = 2, decimal = \".\", thousands = \",\") {\n    if (typeof amount === 'undefined') {\n        return '$0.00';\n    }\n\n    try {\n        decimalCount = Math.abs(decimalCount);\n        decimalCount = isNaN(decimalCount) ? 2 : decimalCount;\n\n        const negativeSign = amount < 0 ? \"-\" : \"\";\n\n        let i = parseInt(amount = Math.abs(Number(amount) || 0).toFixed(decimalCount)).toString();\n        let j = (i.length > 3) ? i.length % 3 : 0;\n\n        let digits = (decimalCount ? decimal + Math.abs(amount - i).toFixed(decimalCount).slice(2) : \"\");\n        if (amount - i === 0) {\n            digits = '';\n        }\n\n        return currency + negativeSign +\n            (j ? i.substr(0, j) + thousands : '') +\n            i.substr(j).replace(/(\\d{3})(?=\\d)/g, \"$1\" + thousands) + digits;\n    } catch (e) {\n        return amount;\n    }\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {formatDollars} from \"../lib\";\n\nexport const ApplicationSummary = (props) => {\n    let ratingYear = new Date().getFullYear() - 1;\n    let taxYear = (new Date().getFullYear() - 2) + '/' + (new Date().getFullYear() - 1);\n\n    let {\n        full_name,\n        occupation,\n        address,\n        ratesBill,\n        noOfDependants,\n        spouse_or_partner,\n        total_income,\n        lived_in_property_1_July,\n        moved_within_rating_year} = props.application;\n\n    let rates_bill_formatted = formatDollars(ratesBill);\n    let total_income_formatted = formatDollars(total_income);\n\n    return (\n        <>\n            <div className=\"controlsBackground\">\n                <div className=\"controls\">\n                    <button className='next' onClick={props.onNext}>NEXT</button>\n                </div>\n            </div>\n            <div className=\"text-content\">\n                <h1>Application summary</h1>\n                <p className=\"summary\">\n                    Please check these details for your rebate claim.\n                </p>\n\n                <p>My name is <strong>{full_name}</strong> and my occupation is <strong>{occupation}</strong>.\n                </p>\n\n                <p>\n                    My address is <strong>{address}</strong> and\n                    {lived_in_property_1_July ? ' I lived here on' : ' I have not lived here'}  1 July {ratingYear}.\n                    {moved_within_rating_year ? ' I have moved ' : ' I have not moved'} within this rating year.\n                </p>\n\n                <p>My {ratingYear} rates bill (including water) is <strong>{rates_bill_formatted}</strong>.</p>\n\n                <p>I have <strong>{noOfDependants}</strong> dependants.</p>\n\n                {spouse_or_partner ?\n                <p>\n                    Our combined income (before tax) for the {taxYear} tax year is <strong>{total_income_formatted}</strong>.\n                </p>\n                    :\n                <p>My income (before tax) for the {taxYear} tax year is <strong>{total_income_formatted}</strong>.</p>\n                }\n            </div>\n        </>\n    )\n};\n\nApplicationSummary.propTypes = {\n    application: PropTypes.shape({\n        full_name: PropTypes.string.isRequired,\n        occupation: PropTypes.string.isRequired,\n        address: PropTypes.string.isRequired,\n        ratesBill: PropTypes.string.isRequired,\n        noOfDependants: PropTypes.string.isRequired,\n        spouse_or_partner: PropTypes.bool.isRequired,\n        total_income: PropTypes.number.isRequired,\n        moved_within_rating_year: PropTypes.bool.isRequired,\n        lived_in_property_1_July: PropTypes.bool.isRequired,\n    })\n};","import React, { useState, useEffect } from 'react';\nimport SignaturePad from 'react-signature-pad-wrapper';\nimport PropTypes from \"prop-types\";\n\nexport const Signature = (props) => {\n    const [error, setError] = useState(false);\n    const [sigCanvas, setSigCanvas] = useState(null);\n\n    const onNext = () => {\n        if (sigCanvas.isEmpty()) {\n            setError(true);\n            document.querySelector('.signature').className = 'signature error';\n        } else {\n            setError(false);\n            props.next({signature: sigCanvas.toDataURL()});\n        }\n    };\n\n    // workaround, SignaturePad react component doesn't set onBegin on sigCanvas\n    useEffect(() => {\n        if (sigCanvas) {\n            sigCanvas.onBegin = hideBackgroundImage;\n        }\n    }, [sigCanvas]);\n\n    function hideBackgroundImage() {\n        setError(false);\n        document.getElementsByClassName(\n            'sigBgImage')[0].style.cssText=\"visibility: hidden; opacity: 0;transition: visibility 0s .35s, opacity .35s linear;\";\n        document.querySelector('.signature').className = 'signature';\n    }\n\n    function showBackgroundImage() {\n        document.getElementsByClassName(\n            'sigBgImage')[0].style.cssText=\"visibility: default; opacity: 1;transition: visibility 0s .35s, opacity .35s linear\";\n    }\n\n    return (\n        <>\n            <div className=\"controlsBackground\">\n                <div className=\"controls\">\n                    <button className='back' name=\"sign\" onClick={props.back}>GO BACK</button>\n                    <button\n                        className='next'\n                        name=\"sign\"\n                        onClick={onNext}>{props.nextButtonLabel}</button>\n                </div>\n            </div>\n\n            <div className=\"text-content\">\n                <h1>{props.title}</h1>\n                <p className=\"summary\">{props.subheading}</p>\n\n                <div className='signature'>\n                    <div className=\"wrap-signature-canvas\">\n                        { error && <p className=\"signature__error-msg\"><span>Please sign before you proceed</span></p>}\n                        <span className=\"sigBgImage\"></span>\n                        <SignaturePad\n                            ref={(ref) => setSigCanvas(ref)}\n                            penColor='#369'\n                            canvasProps={{className: 'sigCanvas'}}\n                            redrawOnResize={true}\n                        />\n                    </div>\n                    {props.declaration === 'applicant' && <DeclarationApplicant data={props.application}/>}\n                    {props.declaration === 'witness' && <DeclarationWitness data={props.witness}/>}\n                </div>\n            </div>\n        </>\n    )\n};\n\nconst DeclarationApplicant = (props) => {\n    return (\n        <p className=\"signatureSection\">\n            I, <strong>{props.data.full_name}</strong> of <strong>{props.data.address}</strong>,\n            occupation <strong>{props.data.occupation}</strong>, solemnly and sincerely declare that I believe the\n            information I have given on this form is true and correct, and I make this solemn declaration\n            conscientiously believing the same to be true and by virtue of the Oaths and Declarations Act 1957.\n        </p>\n    )\n};\n\nconst DeclarationWitness = (props) => {\n    let options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };\n    let date = new Date().toLocaleDateString('en-NZ', options);\n\n    return (\n        <p className=\"signatureSection\">\n            Declared at <strong>{props.data.location}</strong> this&nbsp;\n            <strong>{date}</strong> before me, <strong>{props.data.name}</strong>, <strong>{props.data.occupation}</strong>.\n        </p>\n    )\n};\n\nSignature.propTypes = {\n    title: PropTypes.string.isRequired,\n    declaration: PropTypes.string.isRequired,\n    application: PropTypes.shape({\n        full_name: PropTypes.string.isRequired,\n        address: PropTypes.string.isRequired,\n        occupation: PropTypes.string.isRequired,\n    })\n};","import React from 'react';\nimport '../App.css';\nimport PropTypes from \"prop-types\";\n\nexport const Spinner = (props) => {\n    return (\n        <div className=\"wrap-system-msg\">\n            <p className=\"system-msg system-msg--processing\">{props.message}</p>\n            <div className=\"sk-fading-circle\">\n                <div className=\"sk-circle1 sk-circle\"></div>\n                <div className=\"sk-circle2 sk-circle\"></div>\n                <div className=\"sk-circle3 sk-circle\"></div>\n                <div className=\"sk-circle4 sk-circle\"></div>\n                <div className=\"sk-circle5 sk-circle\"></div>\n                <div className=\"sk-circle6 sk-circle\"></div>\n                <div className=\"sk-circle7 sk-circle\"></div>\n                <div className=\"sk-circle8 sk-circle\"></div>\n                <div className=\"sk-circle9 sk-circle\"></div>\n                <div className=\"sk-circle10 sk-circle\"></div>\n                <div className=\"sk-circle11 sk-circle\"></div>\n                <div className=\"sk-circle12 sk-circle\"></div>\n            </div>\n        </div>\n    );\n};\n\nSpinner.propTypes = {\n    message: PropTypes.string.isRequired,\n};","import React from 'react';\nimport {Spinner} from \"./spinner\";\nimport PropTypes from \"prop-types\";\n\nexport const PendingTask = (props) => {\n\n    const {task, title, errorTitle} = props;\n\n    return (\n        <>\n            {task.pending &&\n            <Spinner message={title} />}\n\n            {task.error &&\n            <div className=\"wrap-system-msg\">\n                <p className=\"system-msg system-msg--error\">{errorTitle}</p>\n                <button className='next' onClick={() => task.start()}>Try Again</button>\n            </div>}\n        </>\n    );\n};\n\nPendingTask.propTypes = {\n    application: PropTypes.shape({\n        task: PropTypes.string.isRequired,\n        title: PropTypes.string.isRequired,\n        errorTitle: PropTypes.string.isRequired,\n    })\n};","export const appReducer = (state, action) => {\n    switch (action.type) {\n        case 'RECEIVED_TOKEN':\n            return {\n                ...state,\n                token: action.data.token,\n                witness: action.data.witness,\n                currentScreen: 'FETCH-APPLICATION',\n            };\n        case 'FETCHED_APPLICATION':\n            return {\n                ...state,\n                currentScreen: 'CONFIRM-APPLICATION',\n                application: action.application,\n            };\n        case 'CONFIRMED_APPLICATION':\n            return {\n                ...state,\n                currentScreen: 'SIGN-APPLICANT',\n            };\n        case 'APPLICANT_SIGNED':\n            return {\n                ...state,\n                currentScreen: 'SIGN-WITNESS',\n                signatureApplicant: action.signature,\n                signatureWitness: ''\n            };\n        case 'CANCEL_APPLICANT_SIGN':\n            return {\n                ...state,\n                currentScreen: 'CONFIRM-APPLICATION',\n                signatureApplicant: '',\n                signatureWitness: '',\n            };\n        case 'WITNESS_SIGNED':\n            return {\n                ...state,\n                currentScreen: 'SUBMITTING-APPLICATION',\n                signatureWitness: action.signature,\n                readyToSubmit: true\n            };\n        case 'CANCEL_WITNESS_SIGN':\n            return {\n                ...state,\n                currentScreen: 'SIGN-APPLICANT',\n                signatureApplicant: '',\n                signatureWitness: ''\n            };\n        case 'APPLICATION_SUBMITTED':\n            return {\n                ...state,\n                currentScreen: 'THANK-YOU',\n            };\n        default: throw new Error('Unhandled action type ' + action.type);\n    }\n};","import 'whatwg-fetch';\nimport {usePendingFetch, useAsyncRun} from \"./lib\";\n\nexport const useFetchApplication = (token, onResult, deps) => {\n    const task = usePendingFetch(async () => {\n        let response = await fetch(`/api/v1/rebate_forms/?jwt=${token}`);\n        let json = await response.json();\n        let fields = json.data.attributes.fields;\n\n        return {\n            full_name: fields.full_name,\n            occupation: fields.occupation,\n            address: fields.location,\n            ratesBill: fields.total_rates,\n            noOfDependants: fields.dependants,\n            spouse_or_partner: (typeof fields.spouse_or_partner !== 'undefined') ? fields.spouse_or_partner === 'yes' : false,\n            total_income: fields.income.total_income,\n            moved_within_rating_year: (typeof fields.moved_within_rating_year !== 'undefined') ? fields.moved_within_rating_year === 'yes' : false,\n            lived_in_property_1_July: (typeof fields.lived_in_property_1_July !== 'undefined') ? fields.lived_in_property_1_July === 'yes' : false,\n        };\n    }, deps);\n\n    useAsyncRun(task, onResult);\n\n    return task;\n};\n\nexport const useSubmitApplication = (state, onResult, deps) => {\n    const task = usePendingFetch(async () => {\n        const {\n            token, \n            signatureApplicant, \n            signatureWitness, \n            application, \n            witness\n        } = state;\n\n        let data = {\n            \"data\": {\n                \"token\": `${token}`,\n                \"signatures\": [\n                    {\n                        \"image\": signatureApplicant,\n                        \"name\": application.full_name,\n                        \"role\": application.occupation,\n                        \"type\": \"applicant\"\n                    },\n                    {\n                        \"image\": signatureWitness,\n                        \"name\": witness.name,\n                        \"role\": witness.occupation,\n                        \"type\": \"witness\"\n                    }\n                ]\n            }\n        };\n\n        let response = await fetch(`/api/v1/rebate_forms/sign`,{\n            method: 'POST', // *GET, POST, PUT, DELETE, etc.\n            mode: 'cors', // no-cors, cors, *same-origin\n            cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n            credentials: 'omit', // include, *same-origin, omit\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            redirect: 'follow', // manual, *follow, error\n            referrer: 'no-referrer', // no-referrer, *client\n            body: JSON.stringify(data), // body data type must match \"Content-Type\" header\n        }).then((response) => {\n            if (response.status >= 200 && response.status < 300) {\n                return response;\n            } else {\n                let error = new Error(response.statusText);\n                error.response = response;\n                throw error;\n            }\n        });\n\n        return await response.json();\n    }, deps);\n\n    useAsyncRun(task, onResult);\n\n    return task;\n};\n","import React from 'react';\nimport {useReducer, useEffect} from 'react';\n\nimport {ApplicationSummary} from \"./components/applicationSummary\";\nimport {Signature} from \"./components/signature\";\nimport {PendingTask} from \"./components/pendingTask\";\n\nimport {appReducer} from './appReducer';\nimport {useFetchApplication, useSubmitApplication} from './services';\nimport {parseJwt} from './lib';\n\nimport './App.css';\nimport tick from './images/tick.svg';\n\n\nfunction App() {\n    const [state, dispatch] = useReducer(appReducer, {});\n\n    useEffect(() => {\n        let urlParams = new URLSearchParams(window.location.search);\n        let token = urlParams.get('t');\n\n        try {\n            let decodedToken = parseJwt(token);\n            dispatch({type: 'RECEIVED_TOKEN', data: {token, witness: decodedToken.witness}});\n        } catch (error) {\n            console.log(error);\n        }\n    }, []);\n\n    const fetchTask = useFetchApplication(state.token, (result) => {\n        dispatch({type: 'FETCHED_APPLICATION', application: result})\n    }, [state.token]);\n\n    const submitTask = useSubmitApplication(state, () => {\n        dispatch({type: 'APPLICATION_SUBMITTED'});\n    }, [state.readyToSubmit]);\n\n    return (\n        <div className=\"App\">\n            <header>\n                <h2>Rates Rebate 2018/2019</h2>\n            </header>\n\n            <div className=\"content\">\n                <PendingTask\n                    task={fetchTask}\n                    title=\"Retrieving application...\"\n                    errorTitle=\"Error while retrieving application\"\n                />\n\n                <PendingTask\n                    task={submitTask}\n                    title=\"Submitting application...\"\n                    errorTitle=\"Error while submitting application\"\n                />\n\n                {state.currentScreen === 'CONFIRM-APPLICATION' &&\n                <ApplicationSummary\n                    application={state.application}\n                    onNext={() => dispatch({type: 'CONFIRMED_APPLICATION'})}\n                />}\n\n                {state.currentScreen === 'SIGN-APPLICANT' &&\n                <Signature\n                    declaration=\"applicant\"\n                    nextButtonLabel=\"NEXT\"\n                    application={state.application}\n                    title=\"Applicant signature\"\n                    subheading=\"Please sign to complete your application\"\n                    next={(data) => dispatch({type: 'APPLICANT_SIGNED', signature: data.signature})}\n                    back={() => dispatch({type: 'CANCEL_APPLICANT_SIGN'})}\n                />}\n\n                {state.currentScreen === 'SIGN-WITNESS' &&\n                <Signature\n                    declaration=\"witness\"\n                    nextButtonLabel=\"SUBMIT\"\n                    application={state.application}\n                    witness={state.witness}\n                    title=\"Witness signature\"\n                    subheading=\"Signature of person authorised to witness this declaration\"\n                    next={(data) => dispatch({type: 'WITNESS_SIGNED', signature: data.signature})}\n                    back={() => dispatch({type: 'CANCEL_WITNESS_SIGN'})}\n                />}\n\n                {state.currentScreen === 'THANK-YOU' &&\n                <div className=\"endScreen\">\n                    <h1>Thank you</h1>\n                    <p className=\"summary\">\n                        This declaration is now complete and ready to be processed.\n                    </p>\n                    <img src={tick} alt=\"tick\" className=\"img-tick\"></img>\n                </div>}\n            </div>\n        </div>\n    );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));"],"sourceRoot":""}