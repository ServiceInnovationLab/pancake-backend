{"version":3,"sources":["images/tick.svg","components/applicationSummary.js","components/signature.js","components/spinner.js","components/pendingTask.js","appReducer.js","lib.js","services.js","App.js","index.js"],"names":["module","exports","__webpack_require__","p","ApplicationSummary","props","ratingYear","Date","getFullYear","taxYear","_props$application","application","full_name","occupation","address","ratesBill","noOfDependants","spouse_or_partner","total_income","react_default","a","createElement","Fragment","className","onClick","onNext","Signature","_useState","useState","_useState2","Object","slicedToArray","error","setError","sigCanvas","name","back","isEmpty","next","signature","toDataURL","nextButtonLabel","title","subheading","build_default","ref","penColor","canvasProps","width","height","onBegin","declaration","signature_DeclarationApplicant","data","signature_DeclarationWitness","witness","DeclarationApplicant","DeclarationWitness","date","toLocaleDateString","weekday","year","month","day","location","Spinner","message","PendingTask","task","errorTitle","pending","spinner_Spinner","start","appReducer","state","action","type","objectSpread","token","currentScreen","signatureApplicant","signatureWitness","readyToSubmit","Error","initialState","started","result","reducer","concat","usePendingFetch","func","deps","_useReducer","useReducer","_useReducer2","dispatch","useEffect","mounted","_ref","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","sent","t0","stop","apply","this","arguments","useAsyncRun","asyncTask","onResult","useFetchApplication","response","json","fetch","abrupt","attributes","fields","total_rates","dependants","income","moved_within_rating_year","useSubmitApplication","_callee2","_context2","signatures","image","role","method","mode","cache","credentials","headers","Content-Type","redirect","referrer","body","JSON","stringify","then","status","statusText","App","URLSearchParams","window","search","get","decodedToken","base64Url","split","base64","decodeURIComponent","atob","map","c","charCodeAt","toString","slice","join","parse","parseJwt","console","log","fetchTask","submitTask","pendingTask_PendingTask","applicationSummary_ApplicationSummary","signature_Signature","src","tick","alt","ReactDOM","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.c8c9dfe1.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/tick.bd37d876.svg\";","import React from 'react';\nimport PropTypes from 'prop-types';\n\nexport const ApplicationSummary = (props) => {\n    let ratingYear = new Date().getFullYear() - 1;\n    let taxYear = (new Date().getFullYear() - 2) + '/' + (new Date().getFullYear() - 1);\n\n    let {\n        full_name,\n        occupation,\n        address,\n        ratesBill,\n        noOfDependants,\n        spouse_or_partner,\n        total_income} = props.application;\n\n    return (\n        <>\n            <div className=\"controlsBackground\">\n                <div className=\"controls\">\n                    <button className='next' onClick={props.onNext}>NEXT</button>\n                </div>\n            </div>\n            <div className=\"text-content\">\n                <h1>Application Summary</h1>\n                <p className=\"summary\">\n                    Please check these details for your rebate claim.\n                </p>\n\n                <p>My name is <strong>{full_name}</strong> and my occupation is <strong>{occupation}</strong>.\n                </p>\n\n                <p>My address is <strong>{address}</strong> and I lived here on 1 July {ratingYear}.\n                    I have not moved within this rating year.</p>\n\n                <p>My {ratingYear} rates bill (including water) is <strong>${ratesBill}</strong>.</p>\n\n                <p>I have <strong>{noOfDependants}</strong> dependant(s).</p>\n\n                {spouse_or_partner ?\n                <p>\n                    The combined income of myself and my [partner or joint home owner] living with me\n                    on 1 July {taxYear} for the {taxYear} tax year was <strong>${total_income}</strong>.\n                </p>\n                    :\n                <p>My income for the {taxYear} tax year was <strong>${total_income}</strong>.</p>\n                }\n            </div>\n        </>\n    )\n};\n\nApplicationSummary.propTypes = {\n    application: PropTypes.shape({\n        full_name: PropTypes.string.isRequired,\n        occupation: PropTypes.string.isRequired,\n        address: PropTypes.string.isRequired,\n        ratesBill: PropTypes.string.isRequired,\n        noOfDependants: PropTypes.string.isRequired,\n        spouse_or_partner: PropTypes.bool.isRequired,\n        total_income: PropTypes.number.isRequired,\n    })\n};","import React, { useState } from 'react';\nimport SignatureCanvas from 'react-signature-canvas';\nimport PropTypes from \"prop-types\";\n\nexport const Signature = (props) => {\n    const [ error, setError ] = useState(false);\n    let sigCanvas = null;\n\n    const onNext = () => {\n        if (sigCanvas.isEmpty()) {\n            setError(true);\n        } else {\n            setError(false);\n            props.next({signature: sigCanvas.toDataURL()});\n        }\n    };\n\n    return (\n        <>\n            <div className=\"controlsBackground\">\n                <div className=\"controls\">\n                    <button className='back' name=\"sign\" onClick={props.back}>GO BACK</button>\n                    <button\n                        className='next'\n                        name=\"sign\"\n                        onClick={onNext}>{props.nextButtonLabel}</button>\n                </div>\n            </div>\n\n            <div className=\"text-content\">\n                <h1>{props.title}</h1>\n                <p className=\"summary\">{props.subheading}</p>\n\n                <div className='signature'>\n                    <div className=\"wrap-signature\">\n                        { error && <p className=\"signature-error\">Please sign before you proceed</p>}\n\n                        <SignatureCanvas\n                            ref={(ref) => {\n                                sigCanvas = ref;\n                            }}\n                            penColor='#369'\n                            canvasProps={{width: '750px', height: '200px', className: 'sigCanvas'}}\n                            onBegin={() => setError(false)}\n                        />\n                    </div>\n                    {props.declaration === 'applicant' && <DeclarationApplicant data={props.application}/>}\n                    {props.declaration === 'witness' && <DeclarationWitness data={props.witness}/>}\n                </div>\n            </div>\n        </>\n    )\n};\n\nconst DeclarationApplicant = (props) => {\n    return (\n        <p className=\"signatureSection\">\n            I, <strong>{props.data.full_name}</strong> of <strong>{props.data.address}</strong>,\n            occupation <strong>{props.data.occupation}</strong> solemnly and sincerely declare that I believe the\n            information I have given on this form is true and correct, and I make this solemn declaration\n            conscientiously believing the same to be true and virtue of the Oaths and Declarations Act 1957.\n        </p>\n    )\n};\n\nconst DeclarationWitness = (props) => {\n    let options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };\n    let date = new Date().toLocaleDateString('en-NZ', options);\n\n    return (\n        <p className=\"signatureSection\">\n            Declared at <strong>{props.data.location}</strong> this&nbsp;\n            <strong>{date}</strong> before me <strong>{props.data.name}</strong>, <strong>{props.data.occupation}</strong>.\n        </p>\n    )\n};\n\nSignature.propTypes = {\n    title: PropTypes.string.isRequired,\n    declaration: PropTypes.string.isRequired,\n    application: PropTypes.shape({\n        full_name: PropTypes.string.isRequired,\n        address: PropTypes.string.isRequired,\n        occupation: PropTypes.string.isRequired,\n    })\n};","import React from 'react';\nimport '../App.css';\nimport PropTypes from \"prop-types\";\n\nexport const Spinner = (props) => {\n    return (\n        <div className=\"wrap-system-msg\">\n            <p className=\"system-msg system-msg--processing\">{props.message}</p>\n            <div className=\"sk-fading-circle\">\n                <div className=\"sk-circle1 sk-circle\"></div>\n                <div className=\"sk-circle2 sk-circle\"></div>\n                <div className=\"sk-circle3 sk-circle\"></div>\n                <div className=\"sk-circle4 sk-circle\"></div>\n                <div className=\"sk-circle5 sk-circle\"></div>\n                <div className=\"sk-circle6 sk-circle\"></div>\n                <div className=\"sk-circle7 sk-circle\"></div>\n                <div className=\"sk-circle8 sk-circle\"></div>\n                <div className=\"sk-circle9 sk-circle\"></div>\n                <div className=\"sk-circle10 sk-circle\"></div>\n                <div className=\"sk-circle11 sk-circle\"></div>\n                <div className=\"sk-circle12 sk-circle\"></div>\n            </div>\n        </div>\n    );\n};\n\nSpinner.propTypes = {\n    message: PropTypes.string.isRequired,\n};","import React from 'react';\nimport {Spinner} from \"./spinner\";\nimport PropTypes from \"prop-types\";\n\nexport const PendingTask = (props) => {\n\n    const {task, title, errorTitle} = props;\n\n    return (\n        <>\n            {task.pending &&\n            <Spinner message={title} />}\n\n            {task.error &&\n            <div className=\"wrap-system-msg\">\n                <p className=\"system-msg system-msg--error\">{errorTitle}</p>\n                <button className='next' onClick={() => task.start()}>Try Again</button>\n            </div>}\n        </>\n    );\n};\n\nPendingTask.propTypes = {\n    application: PropTypes.shape({\n        task: PropTypes.string.isRequired,\n        title: PropTypes.string.isRequired,\n        errorTitle: PropTypes.string.isRequired,\n    })\n};","export const appReducer = (state, action) => {\n    switch (action.type) {\n        case 'RECEIVED_TOKEN':\n            return {\n                ...state,\n                token: action.data.token,\n                witness: action.data.witness,\n                currentScreen: 'FETCH-APPLICATION',\n            };\n        case 'FETCHED_APPLICATION':\n            return {\n                ...state,\n                currentScreen: 'CONFIRM-APPLICATION',\n                application: action.application,\n            };\n        case 'CONFIRMED_APPLICATION':\n            return {\n                ...state,\n                currentScreen: 'SIGN-APPLICANT',\n            };\n        case 'APPLICANT_SIGNED':\n            return {\n                ...state,\n                currentScreen: 'SIGN-WITNESS',\n                signatureApplicant: action.signature,\n                signatureWitness: ''\n            };\n        case 'CANCEL_APPLICANT_SIGN':\n            return {\n                ...state,\n                currentScreen: 'CONFIRM-APPLICATION',\n                signatureApplicant: '',\n                signatureWitness: '',\n            };\n        case 'WITNESS_SIGNED':\n            return {\n                ...state,\n                currentScreen: 'SUBMITTING-APPLICATION',\n                signatureWitness: action.signature,\n                readyToSubmit: true\n            };\n        case 'CANCEL_WITNESS_SIGN':\n            return {\n                ...state,\n                currentScreen: 'SIGN-APPLICANT',\n                signatureApplicant: '',\n                signatureWitness: ''\n            };\n        case 'APPLICATION_SUBMITTED':\n            return {\n                ...state,\n                currentScreen: 'THANK-YOU',\n            };\n        default: throw new Error('Unhandled action type ' + action.type);\n    }\n};","import {useReducer, useEffect} from 'react';\n\nimport 'whatwg-fetch';\n\nconst initialState = {\n    started: false,\n    pending: false,\n    error: null,\n    start: null,\n    result: null,\n};\n\nconst reducer = (task, action) => {\n    switch (action.type) {\n        case 'init':\n            return initialState;\n        case 'ready':\n            return {\n                ...task,\n                start: action.start,\n            };\n        case 'start':\n            return {\n                ...task,\n                started: true,\n                pending: true,\n                error: false,\n            };\n        case 'result':\n            return {\n                ...task,\n                pending: false,\n                result: action.result,\n            };\n        case 'error':\n            return {\n                ...task,\n                pending: false,\n                error: action.error,\n            };\n        default:\n            throw new Error(`Unhandled action type: ${action.type}`);\n    }\n};\n\nexport const usePendingFetch = (func, deps) => {\n    const [state, dispatch] = useReducer(reducer, initialState);\n\n    useEffect(() => {\n        let mounted = true;\n\n        const start = async () => {\n            try {\n                if (deps[0]) {\n                    dispatch({type: 'start'});\n                    let result = await func();\n                    if (mounted) {\n                        dispatch({type: 'result', result});\n                    }\n                }\n            } catch (error) {\n                dispatch({type: 'error', error});\n            }\n        };\n\n        if (deps[0]) {\n            dispatch({type: 'ready', start});\n        }\n\n        return () => {\n            dispatch({ type: 'init' });\n            mounted = false;\n        };\n    }, deps);\n\n    return state;\n};\n\nexport const useAsyncRun = (asyncTask, onResult) => {\n    const start = asyncTask && asyncTask.start;\n    const result = asyncTask && asyncTask.result;\n\n    useEffect(() => {\n        if (start) {\n            start();\n        }\n\n        return () => {\n        };\n    }, [start]);\n\n    useEffect(() => {\n        if (result) {\n            onResult(result);\n        }\n    }, [result]);\n};\n\nexport function parseJwt (token) {\n    var base64Url = token.split('.')[1];\n    var base64 = decodeURIComponent(atob(base64Url).split('').map(function(c) {\n        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n    }).join(''));\n\n    return JSON.parse(base64);\n};\n","import 'whatwg-fetch';\nimport {usePendingFetch, useAsyncRun} from \"./lib\";\n\nexport const useFetchApplication = (token, onResult, deps) => {\n    const task = usePendingFetch(async () => {\n        let response = await fetch(`/api/v1/rebate_forms/?jwt=${token}`);\n        let json = await response.json();\n\n        return {\n            full_name: json.data.attributes.fields.full_name,\n            occupation: json.data.attributes.fields.occupation,\n            address: json.data.attributes.fields.location,\n            ratesBill: json.data.attributes.fields.total_rates,\n            noOfDependants: json.data.attributes.fields.dependants,\n            spouse_or_partner: json.data.attributes.fields.spouse_or_partner === 'yes',\n            total_income: json.data.attributes.fields.income.total_income,\n            moved_within_rating_year: json.data.attributes.fields.moved_within_rating_year === 'yes'\n        };\n    }, deps);\n\n    useAsyncRun(task, onResult);\n\n    return task;\n};\n\nexport const useSubmitApplication = (state, onResult, deps) => {\n    const task = usePendingFetch(async () => {\n        const {\n            token, \n            signatureApplicant, \n            signatureWitness, \n            application, \n            witness\n        } = state;\n\n        let data = {\n            \"data\": {\n                \"token\": `${token}`,\n                \"signatures\": [\n                    {\n                        \"image\": signatureApplicant,\n                        \"name\": application.full_name,\n                        \"role\": application.occupation,\n                        \"type\": \"applicant\"\n                    },\n                    {\n                        \"image\": signatureWitness,\n                        \"name\": witness.name,\n                        \"role\": witness.occupation,\n                        \"type\": \"witness\"\n                    }\n                ]    \n            }\n        };\n\n        let response = await fetch(`/api/v1/rebate_forms/sign`,{\n            method: 'POST', // *GET, POST, PUT, DELETE, etc.\n            mode: 'cors', // no-cors, cors, *same-origin\n            cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\n            credentials: 'omit', // include, *same-origin, omit\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            redirect: 'follow', // manual, *follow, error\n            referrer: 'no-referrer', // no-referrer, *client\n            body: JSON.stringify(data), // body data type must match \"Content-Type\" header\n        }).then((response) => {\n            if (response.status >= 200 && response.status < 300) {\n                return response;\n            } else {\n                let error = new Error(response.statusText);\n                error.response = response;\n                throw error;\n            }\n        });\n\n        return await response.json();\n    }, deps);\n\n    useAsyncRun(task, onResult);\n\n    return task;\n};","import React from 'react';\nimport {useReducer, useEffect} from 'react';\n\nimport {ApplicationSummary} from \"./components/applicationSummary\";\nimport {Signature} from \"./components/signature\";\nimport {PendingTask} from \"./components/pendingTask\";\n\nimport {appReducer} from './appReducer';\nimport {useFetchApplication, useSubmitApplication} from './services';\nimport {parseJwt} from './lib';\n\nimport './App.css';\nimport tick from './images/tick.svg';\n\n\nfunction App() {\n    const [state, dispatch] = useReducer(appReducer, {});\n\n    useEffect(() => {\n        let urlParams = new URLSearchParams(window.location.search);\n        let token = urlParams.get('t');\n\n        try {\n            let decodedToken = parseJwt(token);\n            dispatch({type: 'RECEIVED_TOKEN', data: {token, witness: decodedToken.witness}});\n        } catch (error) {\n            console.log(error);\n        }\n    }, []);\n\n    const fetchTask = useFetchApplication(state.token, (result) => {\n        dispatch({type: 'FETCHED_APPLICATION', application: result})\n    }, [state.token]);\n\n    const submitTask = useSubmitApplication(state, () => {\n        dispatch({type: 'APPLICATION_SUBMITTED'});\n    }, [state.readyToSubmit]);\n\n    return (\n        <div className=\"App\">\n            <header>\n                <h2>Rates Rebate 2018/2019</h2>\n            </header>\n\n            <div className=\"content\">\n                <PendingTask\n                    task={fetchTask}\n                    title=\"Retrieving application...\"\n                    errorTitle=\"Error while retrieving application\"\n                />\n\n                <PendingTask\n                    task={submitTask}\n                    title=\"Submitting application...\"\n                    errorTitle=\"Error while submitting application\"\n                />\n\n                {state.currentScreen === 'CONFIRM-APPLICATION' &&\n                <ApplicationSummary\n                    application={state.application}\n                    onNext={() => dispatch({type: 'CONFIRMED_APPLICATION'})}\n                />}\n\n                {state.currentScreen === 'SIGN-APPLICANT' &&\n                <Signature\n                    declaration=\"applicant\"\n                    nextButtonLabel=\"NEXT\"\n                    application={state.application}\n                    title=\"Applicant signature\"\n                    subheading=\"Please sign to complete your application\"\n                    next={(data) => dispatch({type: 'APPLICANT_SIGNED', signature: data.signature})}\n                    back={() => dispatch({type: 'CANCEL_APPLICANT_SIGN'})}\n                />}\n\n                {state.currentScreen === 'SIGN-WITNESS' &&\n                <Signature\n                    declaration=\"witness\"\n                    nextButtonLabel=\"SUBMIT\"\n                    application={state.application}\n                    witness={state.witness}\n                    title=\"Witness signature\"\n                    subheading=\"Signature of person authorised to witness this declaration\"\n                    next={(data) => dispatch({type: 'WITNESS_SIGNED', signature: data.signature})}\n                    back={() => dispatch({type: 'CANCEL_WITNESS_SIGN'})}\n                />}\n\n                {state.currentScreen === 'THANK-YOU' &&\n                <div className=\"endScreen\">\n                    <h1>Thank you</h1>\n                    <p className=\"summary\">\n                        This declaration is now complete and ready to be processed.\n                    </p>\n                    <img src={tick} alt=\"tick\" className=\"img-tick\"></img>\n                </div>}\n            </div>\n        </div>\n    );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));"],"sourceRoot":""}